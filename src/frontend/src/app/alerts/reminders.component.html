<div class="container-fluid mt-3">
  <div class="row mb-3">
    <div class="col-md-6">
      <h3>Reminders</h3>
    </div>
    <div class="col-md-6 text-end">
      <button class="btn btn-primary" (click)="toggleForm()">
        <i class="fas" [ngClass]="{'fa-plus': !showForm, 'fa-times': showForm}"></i>
        {{ showForm ? 'Cancel' : 'New Reminder' }}
      </button>
      <button class="btn btn-secondary ms-2" (click)="loadReminders()" [disabled]="loading">
        <i class="fas fa-sync" [ngClass]="{'fa-spin': loading}"></i>
        Refresh
      </button>
    </div>
  </div>

  @if (errors.length > 0) {
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      @for (error of errors; track error) {
        <div>{{ error }}</div>
      }
      <button type="button" class="btn-close" (click)="errors = []"></button>
    </div>
  }

  @if (showForm) {
    <app-reminder-form
      [editingReminder]="editingReminder"
      [loading]="loading"
      [errors]="errors"
      [showTickerField]="true"
      (save)="onReminderSave($event)"
      (cancel)="toggleForm()">
    </app-reminder-form>
  }

  <div class="mb-3 d-flex align-items-center justify-content-between">
    <select 
      id="filterState" 
      class="form-select w-auto" 
      [(ngModel)]="filterState" 
      (change)="onFilterChange()">
      <option value="all">All Reminders ({{ reminders.length }})</option>
      <option value="pending">Upcoming</option>
      <option value="sent">Sent</option>
    </select>
    
    <input 
      type="text" 
      id="searchText" 
      class="form-control" 
      placeholder="Search by ticker or message..." 
      [(ngModel)]="searchText" 
      (input)="onFilterChange()"
      style="width: 300px;">
  </div>

  <app-reminder-list
    [reminders]="filteredReminders"
    [loading]="loading && reminders.length === 0"
    [showTickerColumn]="true"
    (edit)="editReminder($event)"
    (delete)="deleteReminder($event)">
  </app-reminder-list>
</div>
