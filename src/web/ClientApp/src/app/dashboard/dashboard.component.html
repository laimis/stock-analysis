<form>
	<div class="form-group">
		<label for="ticker">Symbol</label>
		<input type="text" class="form-control"
			id="ticker"
			aria-describedby="tickerHelp"
			[(ngModel)]="ticker"
      name="ticker"
      autofocus >
		<small id="tickerHelp" class="form-text text-muted">Enter stock symbol</small>
	</div>
	<button type="submit" class="btn btn-primary" (click)="goToStock()" class="invisible">Submit</button>
</form>

<div *ngIf="loaded">


    <h2>Options
      <a [routerLink]="[ '/options/sell']" class="btn btn-primary btn-space">Sell</a>
    </h2>
      <table>
        <tr><td>Total premium</td><td>{{ optionEarnings | currency}}</td></tr>
        <tr><td>Pending premium</td><td>{{ pendingPremium | currency }} (collateral: {{ collateralCash | currency}}, {{ collateralShares }} shares)</td></tr>
      </table>

  <div *ngIf="ownedOptions.length > 0">
    <h2>Open Option Contracts</h2>
    <table class="table">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Type</th>
          <th>Strike</th>
          <th>Expiration</th>
          <th>Premium</th>
          <th>Risk %</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let option of ownedOptions">
          <td><a [routerLink]="[ '/options', option.ticker ]">{{option.ticker}}</a></td>
          <td>{{option.type}}</td>
          <td>{{option.strikePrice | currency}}</td>
          <td>{{option.expiration | date : 'shortDate'}}</td>
          <td>{{option.premium | currency}}</td>
          <td>{{option.riskPct | number }}</td>
          <td><a [routerLink]="[ '/soldoptions', option.ticker, option.type, option.strikePrice, option.expiration ]">edit</a> </td>
        </tr>
      </tbody>
    </table>
  </div>


  <div *ngIf="closedOptions.length > 0">
    <h2>Closed Option Contracts</h2>

    <table class="table">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Type</th>
          <th>Strike</th>
          <th>Expiration</th>
          <th>Premium</th>
          <th>Profit</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let option of closedOptions">
          <td><a [routerLink]="[ '/options', option.ticker ]">{{option.ticker}}</a></td>
          <td>{{option.type}}</td>
          <td>{{option.strikePrice | currency}}</td>
          <td>{{option.expiration | date : 'shortDate'}}</td>
          <td>{{option.premium | currency}}</td>
          <td>{{option.profit | currency }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="owned.length > 0">
    <h2>Owned Stocks</h2>
    <table class="table">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Owned</th>
          <th>Spent</th>
          <th>Earned</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ticker of owned">
          <td><a [routerLink]="[ '/stocks', ticker.ticker ]">{{ticker.ticker}}</a></td>
          <td>{{ticker.owned}}</td>
          <td>{{ticker.spent}}</td>
          <td>{{ticker.earned}}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="cashedOut.length > 0">
    <h2>Cashed Out Stocks</h2>

    <ul>
      <li>Spent: {{totalCashedOutSpend | currency}}</li>
      <li>Earned: {{totalCashedOutEarnings | currency}}</li>
      <li>Profit: {{cashedOutGains() | currency}}, {{cashedOutGainsPct() | number }}%</li>
    </ul>

    <table class="table">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Spent</th>
          <th>Earned</th>
          <th>Net</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ticker of cashedOut">
          <td><a [routerLink]="[ '/stocks', ticker.ticker ]">{{ticker.ticker}}</a></td>
          <td>{{ticker.spent}}</td>
          <td>{{ticker.earned}}</td>
          <td>{{ticker.earned - ticker.spent | currency}}</td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
