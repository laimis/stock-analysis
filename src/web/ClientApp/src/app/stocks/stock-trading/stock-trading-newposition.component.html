<div class="card border-info mb-3">
  <div class="card-header">
    <h5 class="card-title">Record Position</h5>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col">
        <app-symbol-search
              label="Ticker"
              placeholder="New position symbol"
              (tickerSelected)="onBuyTickerSelected($event)"
              cssClass="form-control">
          </app-symbol-search>
      </div>
    </div>
    <div class="row mt-3" *ngIf="ticker">
      <div class="col">
        <label for="costToBuy" class="form-label">Price ( {{ this.ask | currency }} x {{ this.bid | currency }} )</label>
        <input
          type="number"
          id="costToBuy"
          class="form-control"
          [(ngModel)]="costToBuy"
          (ngModelChange)="updateBuyingValuesWithCostToBuy()"
        />
      </div>
      <div class="col">
        <label for="stopPrice" class="form-label">Stop</label>
        <input
          type="number"
          id="stopPrice"
          class="form-control"
          [(ngModel)]="stopPrice"
          (ngModelChange)="updateBuyingValuesStopPrice()"
        />
      </div>
      <div class="col">
        <label for="stocksToBuy" class="form-label">Shares #</label>
        <input
          type="number"
          id="stocksToBuy"
          class="form-control"
          [(ngModel)]="numberOfShares"
          (ngModelChange)="updateBuyingValuesWithNumberOfShares()"
        />
      </div>
      <div class="col">
        <label for="date" class="form-label">Purchase Date</label>
        <input
          type="date"
          class="form-control"
          id="date"
          [(ngModel)]="date">
      </div>
    </div>
    <div class="row mt-3" *ngIf="prices">
      <div class="col fs-6">
        <span class="me-2">Size: <strong>{{ positionSizeCalculated | currency }}</strong></span>
        <span class="me-2">Loss: <strong>{{ potentialLoss | currency }}</strong></span>
        <span class="me-2">Stop %: <strong>{{ stopPct | percent }}</strong></span>
      </div>
      <div class="col text-end">
        <span class="me-2">20: <strong [ngClass]="{'text-success': smaCheck20()}">{{ get20sma() | currency }}</strong></span>
        <span class="me-2">50: <strong [ngClass]="{'text-success': smaCheck50()}">{{ get50sma() | currency }}</strong></span>
        <span class="me-2">150: <strong [ngClass]="{'text-success': smaCheck150()}">{{ get150sma() | currency }}</strong></span>
        <span class="me-2">200: <strong [ngClass]="{'text-success': smaCheck200()}">{{ get200sma() | currency }}</strong></span>
      </div>
    </div>
    <div class="row mt-3" *ngIf="outcomes">
      <div class="col">
        <table class="table table-hover border">
          <tbody>
            <tr *ngFor="let o of filteredOutcomes()">
              <td>
                <span
                        class="badge"
                        [ngClass]="{'bg-success': o.type === 'Positive', 'bg-danger': o.type === 'Negative', 'bg-secondary': o.type === 'Neutral'}">
                        &nbsp;
                    </span>
                </td>
                <td>{{o.key}}</td>
                <td>{{o.value}}</td>
                <td>{{o.type}}</td>
                <td>{{o.message}}</td>
              </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row mt-3" *ngIf="gaps">
      <app-gaps [gaps]="gaps"></app-gaps>
    </div>
    <div class="row mt-3" *ngIf="prices">
      <div class="col">
        <textarea class="form-control" rows="5" [(ngModel)]="notes" placeholder="Notes..."></textarea>
      </div>
    </div>
    <div class="row mt-3" *ngIf="prices">
      <div class="col" >
        <button class="btn btn-primary w-100" (click)="record()">Record</button>
      </div>
    </div>
    <div class="row mt-3" *ngIf="prices && showChart">
      <div class="col">
        <stock-trading-chart
          [prices]="prices"
          [horizontalLines]="stopAndExitPoints"
          [maxPrice]="oneR"></stock-trading-chart>
      </div>
    </div>
  </div>
</div>