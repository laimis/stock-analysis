<div *ngIf="positions">

  <span *ngIf="positions.length==0">
    You have no share purchases recorded.
  </span>
  <div class="mt-4" *ngIf="positions.length > 0">
    <a href="/api/stocks/export/open" class="btn btn-link">Export owned</a>
    <table class="table table-hover">
      <thead>
        <tr>
          <th class="sort-header" (click)="sort('ticker')">Symbol</th>
          <th class="sort-header" (click)="sort('owned')">Shares</th>
          <th class="text-end sort-header" (click)="sort('price')">Price</th>
          <th class="text-end sort-header" (click)="sort('averageCost')">Average Cost</th>
          <th class="text-end sort-header" (click)="sort('invested')" align="center">Invested</th>
          <th class="text-end sort-header" (click)="sort('profits')">Gain/Loss</th>
          <th class="text-end sort-header" (click)="sort('profitsPct')">%</th>
          <th class="text-end sort-header" (click)="sort('equity')">Equity</th>
          <th class="text-end sort-header" (click)="sort('daysheld')">Days Held</th>
          <th class="text-end sort-header" (click)="sort('daysSinceLastTransaction')">Days Since Last Tx</th>
        </tr>
      </thead>
      <tbody>  
        <tr *ngFor="let ticker of positions" [ngClass]="{'bg-warning': highlightRow(ticker)}">
          <td><a [routerLink]="[ '/stocks', ticker.ticker ]">{{ticker.ticker}}</a></td>
          <td>{{ticker.numberOfShares}}</td>
          <td class="text-end">{{ticker.price | currency}}</td>
          <td class="text-end">{{ticker.averageCostPerShare | currency}}</td>
          <td class="text-end">{{ticker.cost | currency}} <small>{{ownershipPct(ticker) | percent}}</small></td>
          <td class="text-end"><span [ngClass]="{'profits-positive': ticker.unrealizedProfit > 0, 'profits-negative': ticker.unrealizedProfit < 0}">{{ticker.unrealizedProfit | currency }}</span></td>
          <td class="text-end"><span [ngClass]="{'profits-positive': ticker.unrealizedProfit > 0, 'profits-negative': ticker.unrealizedProfit < 0}">{{ticker.unrealizedGainPct | percent:'1.2' }}</span></td>
          <td class="text-end">{{ticker.cost + ticker.unrealizedProfit | currency}} <small>{{equityPct(ticker) | percent}}</small></td>
          <td class="text-end">{{ticker.daysHeld}}</td>
          <td class="text-end">{{ticker.daysSinceLastTransaction}}</td>
        </tr>  
      </tbody>
    </table>
  </div>
</div>
