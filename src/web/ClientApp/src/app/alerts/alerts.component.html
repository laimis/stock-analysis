<div *ngIf="monitorGroups">
  <ng-container *ngFor="let g of monitorGroups">

    <h3 class="mt-3">{{g[0].description}}</h3>
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Description</th>
          <th>Threshold</th>
          <th>Last Value</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let monitor of g" [ngClass]="{'bg-warning': monitor.alertType === 'Negative' && monitor.triggeredAlert, 'bg-success': monitor.alertType === 'Positive' && monitor.triggeredAlert}">
          <td>
            <a [routerLink]="[ '/stocks', monitor.ticker ]">{{monitor.ticker}}</a>
          </td>
          <td>
            {{monitor.triggeredAlert?.description || monitor.description}}
          </td>
          <td>{{monitor.thresholdValue | currency}}</td>
          <td>{{monitor.lastSeenValue | currency}}</td>
          <td *ngIf="monitor.triggeredAlert">
            Triggered on {{monitor.triggeredAlert.when | date:'short'}}!
            <a [routerLink]="[ '/stocks', 'newposition' ]" [queryParams]="{'ticker': monitor.ticker, 'numberOfShares': monitor.triggeredAlert.numberOfShares}" class="btn btn-sm btn-primary">Sell</a>
          </td>
          <td *ngIf="!monitor.triggeredAlert"></td>
        </tr>
    </table>
  </ng-container>
  
  <div *ngIf="!container.monitors">
    No price monitors are present
  </div>

  <h3>Recent Triggers</h3>
  <table *ngIf="container.recentlyTriggered" class="table table-hover">
    <thead>
      <tr>
        <th>ticker</th>
        <th>description</th>
        <th>date</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let alert of container.recentlyTriggered" [ngClass]="{'bg-warning': alert.alertType === 'Negative', 'bg-success': alert.alertType === 'Positive'}">
        <td>{{alert.ticker}}</td>
        <td>{{alert.description}}</td>
        <td>{{alert.when | date:'short'}}</td>
        <td>
          <a [routerLink]="[ '/stocks', 'newposition' ]" [queryParams]="{'ticker': alert.ticker, 'numberOfShares': alert.numberOfShares}" class="btn btn-sm btn-primary">Sell</a>
        </td>
      </tr>
  </table>
  <div *ngIf="!container.recentlyTriggered">
    No recent triggers
  </div>
</div>