<div>
  <button (click)="toggleShowDetails()" class="btn btn-primary float-end btn-sm">Show Details</button>
  <table class="table table-hover mt-2" *ngIf="actual && simulations">
    <thead>
      <tr>
        <th>Outcome type</th>
        <th>Status</th>
        <th>Profit</th>
        <th>R/R</th>
        <th>% Gain</th>
        <th>Transactions</th>
        <th>Stop</th>
        <th>Max Gain</th>
        <th>Max Drawdown</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Actual trade</td>
        <td>
          <span *ngIf="actual.isClosed" class="badge bg-success p-2">closed</span>
          <span *ngIf="!actual.isClosed" class="badge bg-warning p-2">open</span>
        </td>
        <td>{{actual.profit + actual.unrealizedProfit | currency}}</td>
        <td>{{actual.rr | number}}</td>
        <td>{{actual.gainPct | percent}}</td>
        <td>
          <div class="badge" [ngClass]="{'bg-info': t.type === 'buy', 'bg-warning': t.type === 'sell'}" *ngFor="let t of actual.transactions">
            {{t.date | date:'shortDate'}} {{t.type}} {{t.numberOfShares}} {{t.price | currency}}
          </div>
        </td>
        <td>{{actual.stopPrice | currency }}</td>
        <td colspan="2"></td>
      </tr>
      <tr *ngIf="showDetails">
        <td></td>
        <td colspan="7">
          <table class="table small">
            <tbody>
              <tr *ngFor="let e of actual.events">
                <td>{{e.date}}</td>
                <td>{{e.type}}</td>
                <td>{{e.value | currency}}</td>
              </tr>
            </tbody>
          </table>
        </td>
      </tr>

      <ng-container *ngFor="let r of simulations.results">
        <tr>
          <td>{{r.strategyName}}</td>
          <td>
            <span *ngIf="r.position.isClosed" class="badge bg-success p-2">closed</span>
            <span *ngIf="!r.position.isClosed" class="badge bg-warning p-2">open</span>
          </td>
          <td>{{r.position.profit + r.position.unrealizedProfit | currency}}</td>
          <td>{{r.position.rr | number}}</td>
          <td>{{r.position.gainPct | percent}}</td>
          <td>
            <div class="badge" [ngClass]="{'bg-info': t.type === 'buy', 'bg-warning': t.type === 'sell'}" *ngFor="let t of r.position.transactions">
              {{t.date | date:'shortDate'}} {{t.type}} {{t.numberOfShares}} {{t.price | currency}}
            </div>
          </td>
          <td>{{r.position.stopPrice | currency }}</td>
          <td>{{r.maxGainPct | percent:'1.0-2'}}</td>
          <td>{{r.maxDrawdownPct | percent:'1.0-2'}}</td>
        </tr>
        <tr *ngIf="showDetails">
          <td></td>
          <td colspan="7">
            <table class="table small">
              <tbody>
                <tr *ngFor="let e of r.position.events">
                  <td>{{e.date}}</td>
                  <td>{{e.type}}</td>
                  <td>{{e.value | currency}}</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
      </ng-container>

    </tbody>
  </table>

</div>