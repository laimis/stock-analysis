<div>
  <div *ngIf="!report">Loading {{title}}...</div>
  <div *ngIf="report" class="mb-3">
    
    <section>
      <h3 *ngIf="title">{{title}}</h3>
      <div *ngIf="showSummary" class="mb-3">
          <span *ngFor="let s of tickersForSummary"
            class="badge rounded-pill me-2"
            [ngClass]="{
              'bg-success': s.count > 0,
              'bg-danger': s.count < 0,
              'bg-secondary': s.count === 0
            }">
              <a class="text-white" [href]="tradingViewLink(s.ticker)" target="_blank">{{s.ticker}}: {{s.count}}</a>
          </span>
      </div>
    </section>
    

    <section class="mt-3 mb-3">
      <h5>Patterns</h5>
      <table class="table table-striped table-hover" *ngIf="hasPatterns(patterns)">
        <tbody>
          <ng-container *ngFor="let tp of report.patterns">
            <tr *ngFor="let p of tp.patterns">
              <td>
                <a [routerLink]="[ '/stocks', tp.ticker ]" target="_blank">{{tp.ticker}}</a>
                <app-trading-view-link [ticker]="tp.ticker"></app-trading-view-link>
              </td>
              <td>{{p.description}}</td>
            </tr>
          </ng-container>
        </tbody>
      </table>
      <div *ngIf="!hasPatterns(patterns)" >No patterns detected</div>
    </section>

    <section>
      <h5>Evaluations</h5>
      <div class="mb-3">
            <span *ngFor="let s of report.evaluationSummary">
              <button *ngIf="s.count > 0" [ngClass]="{'btn-outline-primary': isSelected(s.evaluation)}" class="btn btn-sm" (click)="toggleEvaluation(s.evaluation)">
                {{s.evaluation}} 
                <span
                  class="badge rounded-pill me-2"
                  [ngClass]="{
                    'bg-success': s.type === 'Positive',
                    'bg-danger': s.type === 'Negative',
                    'bg-secondary': s.type === 'Neutral'
                  }">{{s.count}}</span>
              </button>
            </span>
      </div>
      <div *ngFor="let c of report.evaluations" class="mb-5">
        <div *ngIf="isSelected(c.name)">
          <h5 
            [ngClass]="{'text-success': c.type === 'Positive', 'text-danger': c.type === 'Negative' , 'text-secondary': c.type === 'Neutral', 'evaluation': true}"
            style="border: 0px"
            id="{{c.name}}">
            <span class="evaluation-name">{{c.name}}</span>
            <span class="evaluation-count" *ngIf="c.matchingTickers.length > 0">
              {{c.matchingTickers.length}}
            </span>
          </h5>
          <app-outcomes *ngIf="c.matchingTickers.length > 0" [category]="c" [tickerFilter]="tickerFilter"></app-outcomes>
          <span *ngIf="c.matchingTickers.length === 0">No positions in this category</span>
          <button *ngIf="c.matchingTickers.length > 0" class="btn btn-sm btn-outline-secondary mt-2" (click)="copyTickersToClipboard(c)">Copy tickers</button>
        </div>
      </div>
    </section>

  </div>
  
</div>